<nb-card class="organization-dialog">
  <nb-card-header>
    <div class="dialog-header">
        <h5>{{ mode === 'create' ? '创建组织' : '编辑组织' }}</h5>
      <button nbButton ghost status="basic" size="small" (click)="cancel()">
        <nb-icon icon="close-outline"></nb-icon>
      </button>
    </div>
  </nb-card-header>

  <nb-card-body>
    <form [formGroup]="form" novalidate>
      <!-- Code & Name (create mode) -->
      <div class="form-row" *ngIf="mode === 'create'">
        <div class="form-group">
          <label class="label">组织代码</label>
          <input nbInput fullWidth formControlName="code" placeholder="小写字母、数字、下划线"
            [status]="form.get('code')?.invalid && form.get('code')?.touched ? 'danger' : 'basic'" />
        </div>
        <div class="form-group">
          <label class="label">组织名称</label>
          <input nbInput fullWidth formControlName="name" placeholder="组织名称"
            [status]="form.get('name')?.invalid && form.get('name')?.touched ? 'danger' : 'basic'" />
        </div>
      </div>

      <!-- Name only (edit mode) -->
      <div class="form-row" *ngIf="mode === 'edit'">
        <div class="form-group full">
          <label class="label">组织名称</label>
          <input nbInput fullWidth formControlName="name" placeholder="组织名称"
            [status]="form.get('name')?.invalid && form.get('name')?.touched ? 'danger' : 'basic'" />
        </div>
        </div>

        <!-- Description -->
      <div class="form-row">
        <div class="form-group full">
          <label class="label">描述</label>
          <textarea nbInput fullWidth formControlName="description" placeholder="组织描述（可选）" rows="2"></textarea>
        </div>
        </div>

      <!-- Admin (edit mode) -->
      <div class="form-row" *ngIf="mode === 'edit'">
        <div class="form-group full">
          <label class="label">管理员</label>
          <nb-select formControlName="admin_user_id" placeholder="选择管理员（可选）" fullWidth>
              <nb-option *ngFor="let user of availableUsers; trackBy: trackByUserId" [value]="user.id">
              {{ user.username }} <span class="hint" *ngIf="user.email">- {{ user.email }}</span>
              </nb-option>
            </nb-select>
        </div>
      </div>
    </form>
  </nb-card-body>

  <nb-card-footer>
    <button nbButton status="primary" size="small" (click)="submit()" [disabled]="form.invalid">保存</button>
  </nb-card-footer>
</nb-card>
