<!-- 统计信息卡片 - 使用单独的div控制，参考cluster-overview -->
<div class="metric-cards-row">
  <nb-card status="primary" class="metric-card">
    <nb-card-body>
      <div class="metric-card__icon">
        <nb-icon icon="shield-outline" status="primary"></nb-icon>
  </div>
      <div class="metric-card__content">
        <span class="metric-card__title">拥有角色</span>
        <h3 class="metric-card__value">{{ stats.totalRoles }}</h3>
        </div>
      </nb-card-body>
    </nb-card>

  <nb-card status="success" class="metric-card">
      <nb-card-body>
      <div class="metric-card__icon">
        <nb-icon icon="globe-outline" status="success"></nb-icon>
      </div>
      <div class="metric-card__content">
        <span class="metric-card__title">全局权限</span>
        <h3 class="metric-card__value">{{ stats.globalPermissions }}</h3>
        </div>
      </nb-card-body>
    </nb-card>

  <nb-card status="info" class="metric-card">
      <nb-card-body>
      <div class="metric-card__icon">
        <nb-icon icon="layers-outline" status="info"></nb-icon>
      </div>
      <div class="metric-card__content">
        <span class="metric-card__title">数据库权限</span>
        <h3 class="metric-card__value">{{ stats.dbPermissions }}</h3>
        </div>
      </nb-card-body>
    </nb-card>

  <nb-card status="warning" class="metric-card">
      <nb-card-body>
      <div class="metric-card__icon">
        <nb-icon icon="grid-outline" status="warning"></nb-icon>
      </div>
      <div class="metric-card__content">
        <span class="metric-card__title">表级权限</span>
        <h3 class="metric-card__value">{{ stats.tablePermissions }}</h3>
        </div>
      </nb-card-body>
    </nb-card>
  </div>


<!-- 批量操作提示 - 使用nb-alert -->
<nb-alert status="info" *ngIf="selectedPermissions.size > 0" class="mb-3">
  <div class="d-flex justify-content-between align-items-center">
      <span>已选择 {{ selectedPermissions.size }} 个权限</span>
    <div class="d-flex gap-2">
        <button nbButton status="danger" size="small" (click)="batchRevoke()">
          批量撤销
        </button>
        <button nbButton status="basic" size="small" (click)="clearSelection()">
          取消选择
        </button>
      </div>
    </div>
  </nb-alert>

<!-- 加载状态 - 使用ngx-admin标准组件 -->
<div *ngIf="loading" class="text-center py-5">
  <nb-spinner size="giant" status="primary"></nb-spinner>
    <p class="mt-3 text-muted">加载权限数据中...</p>
</div>

<!-- 权限列表 - 使用ng2-smart-table，参考backends组件，直接使用，无wrapper -->
<ng2-smart-table
  *ngIf="!loading"
  [settings]="settings"
  [source]="source"
  (deleteConfirm)="onDeleteConfirm($event)">
</ng2-smart-table>

<!-- 空状态 - 使用nb-card，参考backends组件 -->
<nb-card *ngIf="!loading && filteredPermissions.length === 0" class="text-center py-5">
  <nb-card-body>
    <nb-icon icon="inbox-outline" size="giant" status="info"></nb-icon>
    <h4 class="mt-3">暂无权限数据</h4>
    <p class="text-muted">
      您当前没有任何数据库权限
    </p>
  </nb-card-body>
</nb-card>
